---
title: 군집평가
layout: default
parent: 머신러닝
nav_order: 20
---


# 군집평가

1. **실루엣 점수(Silhouette Score)**: 각 데이터 포인트의 군집 내 거리와 인접 군집과의 거리를 비교하여 계산한다. 이 점수는 -1에서 1 사이의 값을 가지며, 높을수록 군집화 성능이 좋다는 것을 의미한다.
2. **던 인덱스(Dunn Index)**: 군집 내의 거리가 최소화되고, 군집 간 거리가 최대화되는 정도를 측정한다. 높은 값은 좋은 군집화를 나타낸다.
3. **엘보우 방법(Elbow Method)**: 클러스터의 수를 결정하는 데 유용한 방법으로, 클러스터 수에 따른 비용 함수의 감소율을 평가한다. 급격히 감소하는 지점(엘보우)이 최적의 클러스터 수를 나타낸다.
4. **Adjusted Rand Index (ARI)**: 군집화 결과와 실제 레이블 간의 유사성을 측정한다. 0에서 1 사이의 값을 가지며, 1은 완벽한 군집화를 의미한다.



## 실루엣 점수

개별 데이터가 가지는 군집화 지표인 실루엣 계수(Sillhouette coefficient)를 기반으로 한다. 각 데이터 포인트의 군집 내 거리와 인접 군집과의 거리를 비교하여 계산한다. 이 점수는 -1에서 1 사이의 값을 가지며, 높을수록 군집화 성능이 좋다는 것을 의미한다. 쉽게말해 다른 군집과의 거리는 떨어져 있고, 동일 군집끼리의 데이터는 서로 가깝게 형성한 것이 클러스터링이 잘 된것이다.



### 사이킷런 실루엣 분석

[사이킷런 문서](https://scikit-learn.org/stable/modules/generated/sklearn.metrics.silhouette_score.html)

Scikit-learn에서 실루엣 분석을 수행하는 주요 API는 `sklearn.metrics.silhouette_score` 함수이다. 이 함수는 군집화된 데이터에 대한 실루엣 점수를 계산하여, 군집화의 품질을 평가한다.

```python
from sklearn.metrics import silhouette_score

# 예: X는 데이터 포인트, labels는 군집화 결과
score = silhouette_score(X, labels)
```

전체 데이터의 실루엣계수 값을 평균해서 반환한다. 즉 np.mean(silhouette_sample())이다. 일반적으로 이 값이 높을 수록 군집화가 어느정도 잘되었다고 판단할 수 있다. **하지만 이 값이 높다고 해서 군집화가 잘됐다고 판단하면 안된다.** 높은 실루엣 점수는 군집 간 구분이 명확함을 의미하지만, 원래 데이터의 구조나 패턴을 반드시 올바르게 반영하지는 않는다.

**개별 군집의 평균값의 편차가 크지 않아야 한다.** 즉, 개별 군집의 실루엣 계수 평균값이 전체 실루엣 계수의 평균값에서 크게 벗어나지 않는 것이 중요하다. 만약 전체 실루엣 계수의 평균값은 높지만, 특정 군집의 실루엣 계수 평균값이 상대적으로 높거나 한다면 좋은 군집화 조건이 아니다.





## 실루엣분석을 통한 클러스터 개수 선택방법

군집별 평균 실루엣 계수의 시각화를 통한 군집개수 최적화 방법이다. 적합한 클러스터링 개수를 정하는데 있어서 시각화 기법을 사용하면 직관적이며, 적합한 클러스터의 개수를 선택하는데 올바른 선택을 할 수있다.

[사이킷런 문서](https://scikit-learn.org/stable/auto_examples/cluster/plot_kmeans_silhouette_analysis.html)

실루엣 플롯의 두께를 통해 클러스터의 크기를 시각화할 수 있으며, 클러스터 수에 따라 실루엣 점수가 달라진다. 예를 들어, `n_clusters`가 2일 때 평균 실루엣 점수는 0.7049, 3일 때는 0.5882, 4일 때는 0.6505, 5일 때는 0.5615, 6일 때는 0.4858이다. 이 분석은 특정 데이터셋에 대해 `n_clusters` 값으로 3, 5, 6을 선택하는 것이 좋지 않음을 보여주며, 스코어값이 높다고해서 좋은 것이아님을 알 수 있다.

클러스터가 2일때는 0과 1로만 너무 일반화되었다. 스코어가 가장 높지만 이것이 좋은 군집화라기엔 좋지 않다.