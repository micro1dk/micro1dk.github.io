---
title: 데이터전처리-Missing data
layout: default
parent: 머신러닝
nav_order: 2
---

# Data preprocessing

데이터 전처리과정은 

* 결손값 처리
* 인코딩
* 스케일링
* 이상치 제거
* Feature 선택, 추출 및 가공



# Missing data

머신러닝 알고리즘은 입력데이터가 **완전하게 제공되었을 때 가장 잘 작동**한다. 다시말해 각 Feature가 모든 관측치에 대해 값을 가지고 있어야한다. 

실제 데이터 수집에서는 분명 누락된 값이 존재한다. 이런 누락된 값은 통계적 분석이나 모델 성능에 악영향을 미친다. 

누락 데이터를 찾고 처리하는 과정을 알아보자면



## 누락 데이터 찾기

`isnull()` 또는 `isna()`를 사용하여 누락된 값을 찾을 수 있다.

```python
df.isnull()
```





## 누락 데이터 처리하기

누락 데이터 처리방법에는 '제거' 또는 '채우기'가 있다. 무엇을 할지 결정을 내릴 때 고려해야할 사항이 있다.

* **데이터의 양** : 누락된 값이 많은 경우 데이터를 제거하면 데이터셋의 대부분을 잃는다. 이럴땐 적절한 값으로 누락된 값을 채운다.
* **데이터의 중요성** : 누락된 값이 포함된 특성이, Target 변수와 관련이 없거나 중요하지 않다고 판단되면 제거한다. 반대로 중요하다면 채우는것이 낫다.
* **누락값의 패턴** : 누락된 값이 무작위로 발생했을 때, 패턴을 고려하여 채우거나 지워야한다.



먼저 누락데이터를 제거하기 위해 `dropna()` 메서드를 사용한다. 특정 열에 대해서만 제거하고 싶다면 `subset` 옵션을 사용한다.

```python
df.dropna() # 누락 데이터가 있는 해당 행을 통째로 지움 
df.dropna(axis=1)  # 누락 데이터가 있는 해당 열을 통째로 지움
df.dropna(subset=['column_name']) # 누락데이터가 있는 행의 특정 열에 대해서 지움
```



데이터를 채울 때는 `fill()` 메서드를 사용한다. 채우는 값에 대해서 고려해야할 사항이 있다.

* **평균(mean) 또는 중앙값(median)**: 수치형 데이터의 경우 해당 열의 평균이나 중앙값으로 채운다. 데이터 분포가 왜곡되어 있거나 이상치가 있는 경우 적합하지 않다.
* **최빈값(mode)**: 범주형 데이터의 경우, 누락 해당 열의 최빈값으로 채울 수 있다. 역시 분포가 왜곡되어 있거나 이상치가 있는 경우 문제가 발생한다.
* **0** : 0으로 채울 땐 몇 가지 고려해야할 사항이 있다.
  * 0이 자체적 의미를 가지는 경우. 예를 들어 상품판매 데이터가 누락되었을 때, 팔리지 않았음을 의미할 수 있으므로 0으로 채운다.
  * 스케일링을 위해 데이터의 평균을 0 근처가 되도록 정규화를 하는데, 누락된 값을 0으로 대체하면 모델의 성능에 도움이된다.
  * 특성 대부분값이 0인 희소행렬 (sparse matrix)인 경우 누락된 값을 0으로 채우는것이 괜찮다.



```python
df.fillna(0) # 0으로 채우기
df.fillna(df.mean()) # 변수별 평균으로 채우기

df.fillna(method= 'ffill') # 결측치 이전의 유효한 값으로 채움. pad와 동일
df.fillna(method= 'bfill') # 결측치 다음의 유효한 값으로 채움. backfill과 동일
```



시계열 데이터에서는 보간(interpolation)하여 채울 수 있다.  보간 방법으로는  'linear', 'nearest', 'zero', 'slinear', 'quadratic', 'cubic' 등이 있다. 기본값은 'linear'이다.

```python
df.interpolate() # Nan값을 앞뒤의 값의 동일 간격으로 채우기
df.interpolate(method='linear') # 선형으로 비례하는 값들로 결측치를 채움
df.interpolate(method='linear', limit=1) # 보간하는 개수를 1개로 제한함.
df.interpolate(method='cubic', limit=2, limit_direction='backward')
```
